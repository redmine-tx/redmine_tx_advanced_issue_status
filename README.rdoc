= Redmine Tx Advanced Issue Status

== í”„ë¡œì íŠ¸ ê°œìš”

ì´ í”ŒëŸ¬ê·¸ì¸ì€ Redmineì˜ ê¸°ë³¸ ì´ìŠˆ ìƒíƒœ(IssueStatus)ì— ì˜ë¯¸ë¥¼ ë¶€ì—¬í•˜ëŠ” "Redmine Tx Advanced Issue Status" í”ŒëŸ¬ê·¸ì¸ì…ë‹ˆë‹¤. Rubyë¡œ ì‘ì„±ë˜ì—ˆìœ¼ë©° í‘œì¤€ Redmine í”ŒëŸ¬ê·¸ì¸ êµ¬ì¡°ë¥¼ ë”°ë¦…ë‹ˆë‹¤.

=== ë¬¸ì œì ê³¼ í•´ê²°ì±…

*ê¸°ì¡´ ë¬¸ì œì :*
* ë ˆë“œë§ˆì¸ì˜ ê¸°ë³¸ ì´ìŠˆ ìƒíƒœì—ëŠ” "Is closed" í”Œë˜ê·¸ë§Œ ì¡´ì¬í•˜ì—¬ ì´ìŠˆê°€ ì–´ë–¤ ë‹¨ê³„ì— ìˆëŠ”ì§€ íŒŒì•…í•˜ê¸° ì–´ë ¤ì›€
* ì´ìŠˆì˜ ì§„í–‰ ìƒíƒœë¥¼ í”„ë¡œê·¸ë˜ë°ì ìœ¼ë¡œ êµ¬ë¶„í•˜ê³  í™œìš©í•˜ê¸° ì–´ë ¤ì›€

*í•´ê²°ì±…:*
* IssueStatus ëª¨ë¸ì— +stage+ í•„ë“œë¥¼ ì¶”ê°€í•˜ì—¬ ì´ìŠˆ ìƒíƒœì— ë‹¨ê³„ë³„ ì˜ë¯¸ë¥¼ ë¶€ì—¬
* ë‹¨ê³„ë³„ íŒë‹¨ ë©”ì†Œë“œë¥¼ ì œê³µí•˜ì—¬ ë‹¤ë¥¸ í”ŒëŸ¬ê·¸ì¸ì—ì„œ ì‰½ê²Œ í™œìš© ê°€ëŠ¥

== í•µì‹¬ ê°œë…

=== Stage ë‹¨ê³„ ì •ì˜

í”ŒëŸ¬ê·¸ì¸ì€ ì´ìŠˆ ìƒíƒœë¥¼ 9ê°œì˜ ë‹¨ê³„ë¡œ ë¶„ë¥˜í•©ë‹ˆë‹¤:

  STAGE_DISCARDED   = -2  # íê¸°ë¨
  STAGE_POSTPONED   = -1  # ë³´ë¥˜ë¨
  STAGE_NEW         = 0   # ì‹ ê·œ
  STAGE_SCOPING     = 1   # ê²€í† ì¤‘
  STAGE_IN_PROGRESS = 2   # ì§„í–‰ì¤‘
  STAGE_REVIEW      = 3   # ê²€ìˆ˜ì¤‘
  STAGE_IMPLEMENTED = 4   # êµ¬í˜„ë
  STAGE_QA          = 5   # QA
  STAGE_COMPLETED   = 6   # ì¢…ê²°

=== ë‹¨ê³„ë³„ ì˜ë¯¸

* *DISCARDED (-2)*: ì´ìŠˆê°€ íê¸°ë˜ì–´ ë” ì´ìƒ ì‘ì—…í•˜ì§€ ì•ŠìŒ
* *POSTPONED (-1)*: ì´ìŠˆê°€ ë³´ë¥˜ë˜ì–´ ë‹¹ë¶„ê°„ ì‘ì—…í•˜ì§€ ì•ŠìŒ
* *NEW (0)*: ì‹ ê·œ ìƒì„±ëœ ì´ìŠˆë¡œ ì•„ì§ ì‘ì—…ì´ ì‹œì‘ë˜ì§€ ì•ŠìŒ
* *SCOPING (1)*: ì´ìŠˆì˜ ë²”ìœ„ì™€ ìš”êµ¬ì‚¬í•­ì„ ê²€í† í•˜ëŠ” ë‹¨ê³„
* *IN_PROGRESS (2)*: ì´ìŠˆë¥¼ ì ê·¹ì ìœ¼ë¡œ ì‘ì—… ì¤‘ì¸ ë‹¨ê³„
* *REVIEW (3)*: ì‘ì—…ì´ ì™„ë£Œë˜ì–´ ê²€ìˆ˜ë¥¼ ë°›ëŠ” ë‹¨ê³„
* *IMPLEMENTED (4)*: êµ¬í˜„ì´ ì™„ë£Œëœ ë‹¨ê³„
* *QA (5)*: í’ˆì§ˆ ë³´ì¦ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ” ë‹¨ê³„
* *COMPLETED (6)*: ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë˜ì–´ ì¢…ê²°ëœ ë‹¨ê³„

== API ì‚¬ìš©ë²•

=== IssueStatus í´ë˜ìŠ¤ ë©”ì†Œë“œ

ê° ì´ìŠˆ ìƒíƒœë¥¼ íŒë‹¨í•˜ëŠ” í´ë˜ìŠ¤ ë©”ì†Œë“œê°€ ì œê³µë©ë‹ˆë‹¤:

  # ìƒíƒœ IDë¡œ ë‹¨ê³„ í™•ì¸
  IssueStatus.is_new?(status_id)         # ì‹ ê·œì¸ê°€?
  IssueStatus.is_postponed?(status_id)   # ë³´ë¥˜ì¸ê°€?
  IssueStatus.is_discarded?(status_id)   # íê¸°ì¸ê°€?
  IssueStatus.is_in_progress?(status_id) # ì§„í–‰ì¤‘ì¸ê°€? (IN_PROGRESS ë˜ëŠ” REVIEW)
  IssueStatus.is_in_review?(status_id)   # ê²€ìˆ˜ì¤‘ì¸ê°€?
  IssueStatus.is_implemented?(status_id) # êµ¬í˜„ì™„ë£Œì¸ê°€? (IMPLEMENTED ì´ìƒ)
  IssueStatus.is_qa?(status_id)          # QA ë‹¨ê³„ì¸ê°€?
  IssueStatus.is_completed?(status_id)   # ì¢…ê²°ë˜ì—ˆëŠ”ê°€?

  # íŠ¹ì • ë‹¨ê³„ì˜ ëª¨ë“  ìƒíƒœ ID ëª©ë¡ ì–»ê¸°
  IssueStatus.new_ids          # ì‹ ê·œ ìƒíƒœ ID ë°°ì—´
  IssueStatus.discarded_ids    # íê¸° ìƒíƒœ ID ë°°ì—´
  IssueStatus.postponed_ids    # ë³´ë¥˜ ìƒíƒœ ID ë°°ì—´
  IssueStatus.in_progress_ids  # ì§„í–‰ì¤‘ ìƒíƒœ ID ë°°ì—´
  IssueStatus.implemented_ids  # êµ¬í˜„ì™„ë£Œ ìƒíƒœ ID ë°°ì—´
  IssueStatus.in_review_ids    # ê²€ìˆ˜ì¤‘ ìƒíƒœ ID ë°°ì—´
  IssueStatus.completed_ids    # ì¢…ê²° ìƒíƒœ ID ë°°ì—´

  # ìƒíƒœ IDë¡œ ìƒíƒœ ì´ë¦„ì´ë‚˜ ë‹¨ê³„ ì–»ê¸°
  IssueStatus.get_name(status_id)   # ìƒíƒœ ì´ë¦„
  IssueStatus.get_stage(status_id)  # stage ê°’

=== Issue ì¸ìŠ¤í„´ìŠ¤ ë©”ì†Œë“œ

Issue ê°ì²´ì—ì„œë„ ë™ì¼í•œ ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

  issue = Issue.find(1)

  issue.is_new?         # ì‹ ê·œì¸ê°€?
  issue.is_postponed?   # ë³´ë¥˜ì¸ê°€?
  issue.is_discarded?   # íê¸°ì¸ê°€?
  issue.is_in_progress? # ì§„í–‰ì¤‘ì¸ê°€?
  issue.is_in_review?   # ê²€ìˆ˜ì¤‘ì¸ê°€?
  issue.is_implemented? # êµ¬í˜„ì™„ë£Œì¸ê°€?
  issue.is_qa?          # QA ë‹¨ê³„ì¸ê°€?
  issue.is_completed?   # ì¢…ê²°ë˜ì—ˆëŠ”ê°€?

=== IssueStatus ì¸ìŠ¤í„´ìŠ¤ ë©”ì†Œë“œ

IssueStatus ê°ì²´ì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥:

  status = IssueStatus.find(1)

  status.is_new?         # ì‹ ê·œì¸ê°€?
  status.is_postponed?   # ë³´ë¥˜ì¸ê°€?
  status.is_discarded?   # íê¸°ì¸ê°€?
  status.is_in_progress? # ì§„í–‰ì¤‘ì¸ê°€?
  status.is_in_review?   # ê²€ìˆ˜ì¤‘ì¸ê°€?
  status.is_implemented? # êµ¬í˜„ì™„ë£Œì¸ê°€?
  status.is_qa?          # QA ë‹¨ê³„ì¸ê°€?
  status.is_completed?   # ì¢…ê²°ë˜ì—ˆëŠ”ê°€?
  status.stage_name      # ë‹¨ê³„ ì´ë¦„ (i18n ì ìš©)

== ì‹¤ì œ ì‚¬ìš© ì˜ˆì œ

=== redmine_tx_milestone í”ŒëŸ¬ê·¸ì¸ì—ì„œì˜ ì‚¬ìš© ì‚¬ë¡€

1. *ê°„íŠ¸ ì°¨íŠ¸ì—ì„œ íê¸°ëœ ì´ìŠˆ í•„í„°ë§*

  # íê¸°ëœ ì´ìŠˆ ì œì™¸
  issues = Issue.where(...).select { |issue| !IssueStatus.is_discarded?(issue.status_id) }

2. *ì´ìŠˆ ìŠ¤íƒ€ì¼ ì ìš©*

  def get_issue_style(issue)
    if IssueStatus.is_postponed?(issue.status_id)
      'color: #860;'
    elsif IssueStatus.is_discarded?(issue.status_id)
      'color: #aaa; text-decoration: line-through; opacity: 0.8;'
    elsif IssueStatus.is_implemented?(issue.status_id)
      'color: #aaa;'
    elsif IssueStatus.is_in_progress?(issue.status_id)
      'font-weight: bold;'
    end
  end

3. *ì´ìŠˆ ì•„ì´ì½˜ í‘œì‹œ*

  <% if IssueStatus.is_discarded?(issue.status_id) %>
    <span>ğŸ—‘ï¸</span>
  <% elsif IssueStatus.is_implemented?(issue.status_id) %>
    <span>âœ“</span>
  <% elsif IssueStatus.is_in_review?(issue.status_id) %>
    ğŸ”
  <% elsif IssueStatus.is_new?(issue.status_id) && issue.start_date <= Date.today %>
    âš ï¸
  <% end %>

4. *êµ¬í˜„ ì™„ë£Œëœ ì´ìŠˆ ì œì™¸í•˜ê¸°*

  # ì•„ì§ êµ¬í˜„ì´ ì™„ë£Œë˜ì§€ ì•Šì€ ì´ìŠˆë§Œ ì¡°íšŒ
  active_issues = Issue.where.not(status_id: IssueStatus.implemented_ids)

5. *ìë™ ìŠ¤ì¼€ì¤„ë§ì—ì„œ í™•ì •ëœ ì´ìŠˆ íŒë‹¨*

  # ì§„í–‰ì¤‘ì´ê±°ë‚˜ ì¼ì •ì´ í™•ì •ëœ ì´ìŠˆ
  fixed_issues = issues.select { |issue| 
    issue.is_in_progress? || (issue.start_date.present? && issue.due_date.present?)
  }

6. *ì¼ì • ìš”ì•½ì—ì„œ ì§„í–‰ì¤‘ì¸ ì´ìŠˆë§Œ ê°•ì¡°*

  in_progress_status_ids = IssueStatus.new_ids + IssueStatus.in_progress_ids + IssueStatus.in_review_ids
  is_in_progress = in_progress_status_ids.include?(status_id)
  font_color = is_in_progress ? "#555555" : "#AAAAAA"

== ì¶”ê°€ ê¸°ëŠ¥

=== 1. Done Ratio ìë™ ì—…ë°ì´íŠ¸

ì„¤ì •ì´ í™œì„±í™”ë˜ë©´ ì´ìŠˆ ìƒíƒœ ë³€ê²½ ì‹œ ìì‹ì´ ì—†ëŠ” ë§ë‹¨ ì´ìŠˆì˜ ì™„ë£Œ ë¹„ìœ¨(done_ratio)ì´ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤:

  # enable_hybrid_logic ì„¤ì •ì´ trueì¼ ë•Œ
  # ìƒíƒœ ë³€ê²½ ì‹œ ìƒíƒœì˜ default_done_ratio ê°’ìœ¼ë¡œ done_ratio ìë™ ì„¤ì •

=== 2. ë¶€ëª¨-ìì‹ ì´ìŠˆ ë™ê¸°í™”

í”ŒëŸ¬ê·¸ì¸ ì„¤ì •ì— ë”°ë¼ ë‹¤ì–‘í•œ ë™ê¸°í™” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤:

  # enable_auto_sync_target_version: ë¶€ëª¨ ì´ìŠˆì˜ ë²„ì „ì´ ë³€ê²½ë˜ë©´ ìì‹ ì´ìŠˆì˜ ë²„ì „ë„ ë³€ê²½
  # enable_auto_sync_priority: ë¶€ëª¨ ì´ìŠˆì˜ ì¤‘ìš”ë„ê°€ ë³€ê²½ë˜ë©´ ìì‹ ì´ìŠˆì˜ ì¤‘ìš”ë„ë„ ë³€ê²½
  # enable_auto_sync_tag: ë¶€ëª¨ ì´ìŠˆì˜ íƒœê·¸ê°€ ë³€ê²½ë˜ë©´ ìì‹ ì´ìŠˆì˜ íƒœê·¸ë„ ë™ê¸°í™”
  # enable_parent_auto_update: ìì‹ ì´ìŠˆê°€ ì‹œì‘ë˜ë©´ ë¶€ëª¨ ì´ìŠˆë„ ìë™ìœ¼ë¡œ ì‹œì‘ ìƒíƒœë¡œ ë³€ê²½

== ë‹¤ë¥¸ í”ŒëŸ¬ê·¸ì¸ì—ì„œ í™œìš©í•˜ê¸°

=== ê¶Œì¥ ì‚¬ìš© íŒ¨í„´

1. *ì´ìŠˆ í•„í„°ë§*

  # í™œì„±í™”ëœ ì´ìŠˆë§Œ (íê¸°/ë³´ë¥˜ ì œì™¸)
  active_issues = issues.reject { |i| i.is_discarded? || i.is_postponed? }

  # ì‘ì—…ì´ í•„ìš”í•œ ì´ìŠˆë§Œ (ì‹ ê·œ + ì§„í–‰ì¤‘)
  work_needed = issues.select { |i| i.is_new? || i.is_in_progress? }

2. *ì´ìŠˆ ìƒíƒœë³„ ì§‘ê³„*

  # ë‹¨ê³„ë³„ ì´ìŠˆ ê°œìˆ˜
  stats = {
    new: issues.count { |i| i.is_new? },
    in_progress: issues.count { |i| i.is_in_progress? },
    implemented: issues.count { |i| i.is_implemented? },
    completed: issues.count { |i| i.is_completed? }
  }

3. *ì¡°ê±´ë¶€ ë¡œì§*

  # ì´ìŠˆê°€ êµ¬í˜„ ì™„ë£Œëœ ê²½ìš°ì—ë§Œ íŠ¹ì • ë™ì‘ ìˆ˜í–‰
  if issue.is_implemented?
    # êµ¬í˜„ ì™„ë£Œ í›„ ì²˜ë¦¬
  end

  # ì§„í–‰ ì¤‘ì¸ ì´ìŠˆì— ëŒ€í•œ ê²½ê³ 
  if issue.is_in_progress? && issue.due_date < Date.today
    # ë§ˆê°ì¼ ê²½ê³ 
  end

== ì•„í‚¤í…ì²˜

=== ë°ì´í„°ë² ì´ìŠ¤ ë³€ê²½

  # Migration: 1_add_stage_to_issue_status.rb
  # issue_statuses í…Œì´ë¸”ì— stage ì»¬ëŸ¼(integer) ì¶”ê°€

=== ì£¼ìš” íŒŒì¼

* *init.rb*: í”ŒëŸ¬ê·¸ì¸ ì´ˆê¸°í™” ë° ì„¤ì • ì •ì˜
* *lib/tx_advanced_issue_status_helper.rb*: ìƒìˆ˜ ì •ì˜ ë° ë‹¨ê³„ íŒë‹¨ í—¬í¼ ë©”ì†Œë“œ
* *lib/tx_advanced_issue_status_issue_status_patch.rb*: IssueStatus ëª¨ë¸ íŒ¨ì¹˜
* *lib/tx_advanced_issue_status_issue_patch.rb*: Issue ëª¨ë¸ íŒ¨ì¹˜ (done_ratio ìë™ ì—…ë°ì´íŠ¸ ë° ë™ê¸°í™” ë¡œì§)
* *app/views/settings/_tx_advanced_issue_status.html.erb*: í”ŒëŸ¬ê·¸ì¸ ì„¤ì • UI

=== ì„±ëŠ¥ ìµœì í™”

ì´ìŠˆ ìƒíƒœ ëª©ë¡ì€ 5ë¶„ê°„ ìºì‹œë©ë‹ˆë‹¤:

  # TxAdvancedIssueStatusHelper.all_issue_statuses
  # 5ë¶„ë§ˆë‹¤ ìë™ìœ¼ë¡œ ìƒˆë¡œê³ ì¹¨ë˜ëŠ” ìºì‹œ

== í”ŒëŸ¬ê·¸ì¸ ì„¤ì •

ê´€ë¦¬ > í”ŒëŸ¬ê·¸ì¸ > Redmine Tx Advanced Issue Statusì—ì„œ ë‹¤ìŒ ì˜µì…˜ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* *enable_hybrid_logic*: ì´ìŠˆ ìƒíƒœì— ë”°ë¥¸ ì™„ë£Œ ë¹„ìœ¨ ìë™ ì—…ë°ì´íŠ¸ (ê¸°ë³¸ê°’: true)
* *enable_auto_sync_target_version*: ë¶€ëª¨ ì´ìŠˆ ë²„ì „ ë³€ê²½ ì‹œ ìì‹ ì´ìŠˆ ë²„ì „ ë™ê¸°í™” (ê¸°ë³¸ê°’: false)
* *enable_auto_sync_priority*: ë¶€ëª¨ ì´ìŠˆ ì¤‘ìš”ë„ ë³€ê²½ ì‹œ ìì‹ ì´ìŠˆ ì¤‘ìš”ë„ ë™ê¸°í™” (ê¸°ë³¸ê°’: false)
* *enable_auto_sync_tag*: ë¶€ëª¨ ì´ìŠˆ íƒœê·¸ ë³€ê²½ ì‹œ ìì‹ ì´ìŠˆ íƒœê·¸ ë™ê¸°í™” (ê¸°ë³¸ê°’: false)
* *enable_parent_auto_update*: ìì‹ ì´ìŠˆ ì‹œì‘ ì‹œ ë¶€ëª¨ ì´ìŠˆ ìë™ ì‹œì‘ (ê¸°ë³¸ê°’: false)

== ì£¼ì˜ì‚¬í•­

1. *ë ˆë“œë§ˆì¸ ì „ì—­ ì„¤ì •*: "ì´ìŠˆ ìƒíƒœì— ë”°ë¥¸ ì™„ë£Œìœ¨ ê³„ì‚°" ì˜µì…˜ì„ êº¼ì•¼ ì´ í”ŒëŸ¬ê·¸ì¸ì´ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤.
2. *ë¶€ëª¨-ìì‹ ê´€ê³„*: ë¶€ëª¨ ì´ìŠˆëŠ” ìì‹ ì´ìŠˆì˜ ì™„ë£Œ ë¹„ìœ¨ì— ë”°ë¼ ìë™ ê³„ì‚°ë˜ë¯€ë¡œ, ìƒíƒœ ë³€ê²½ ì‹œ ì™„ë£Œ ë¹„ìœ¨ì´ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
3. *íƒœê·¸ ë™ê¸°í™”*: enable_auto_sync_tag ê¸°ëŠ¥ì€ redmine_tags í”ŒëŸ¬ê·¸ì¸ì´ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ ì‘ë™í•©ë‹ˆë‹¤.

== ì˜ì¡´ì„±

ì´ í”ŒëŸ¬ê·¸ì¸ì€ ë…ë¦½ì ìœ¼ë¡œ ì‘ë™í•˜ë©° ë‹¤ë¥¸ í”ŒëŸ¬ê·¸ì¸ì— ì˜ì¡´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

== ê°œë°œ ê°€ì´ë“œë¼ì¸

=== ì½”ë“œ ìŠ¤íƒ€ì¼
* Ruby on Rails ê·œì¹™ì„ ë”°ë¦…ë‹ˆë‹¤
* ì£¼ì„ì€ í•œêµ­ì–´ë¡œ ì‘ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤

=== í…ŒìŠ¤íŠ¸

  # Redmine ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ì‹¤í–‰
  bundle exec rake test:plugins:redmine_tx_advanced_issue_status

== ì‘ì„±ì

Author: KiHyun Kang
